#! /bin/csh
# *Cassiopee* machine specific (local) variables

# Preliminary checks
if ($?CASSIOPEE == 0) then
    echo "You must specify a CASSIOPEE variable in your environment."
    echo "This variable specifies the installation path of *Cassiopee*."
    exit
endif

# Compilation on different machines:
# eos: x86 processors, intel compilers -> x86
# cephee: x86 processors, intel compilers -> cp
# stelvio: x86 processors, intel compilers -> stv
# tiamat: x86 processors, intel compilers -> tia

# Detection machine
set KC=`uname -n`
#set KC='linux64' # production linux64
set MAC0=`echo $KC | grep 'ld'`
set MAC1=`echo $KC | grep 'ldmfn423z'`
set MAC3=`echo $KC | grep 'node6.cluster'`
set MAC4=`echo $KC | grep 'oneroa1'`
set MAC5=`echo $KC | grep 'mangrove'`
set MAC6=`echo $KC | grep 'ubuntu'`
set MAC7=`echo $KC | grep 'cc-wdsna'`
set MAC8=`echo $KC | grep 'localhost'`
set MAC9=`echo $KC | grep 'service'`
set MAC10=`echo $KC | grep 'r'`
set MAC11=`echo $KC | grep 'fulvio'`
set MAC12=`echo $KC | grep 'fujin'`
set MAC13=`echo $KC | grep 'daapuv'`
set MAC14=`echo $KC | grep 'visio'`
set MAC15=`echo $KC | grep 'tiamat'`
set MAC16=`echo $KC | grep 'austri'`
set MAC17=`echo $KC | grep 'laura'`
set MAC18=`echo $KC | grep 'celeste'`
set MAC19=`echo $KC | grep 'elmer'`
set MAC20=`echo $KC | grep 'dumbo'`
set MAC21=`echo $KC | grep 'ganesh'`
set MAC22=`echo $KC | grep 'linux64'`
set MAC23=`echo $KC | grep 'moloch'`
set MAC24=`echo $KC | grep 'giulia'`
set MAC25=`echo $KC | grep 'westri'`
set MAC26=`echo $KC | grep 'sator'`
set MAC27=`echo $KC | grep 'n'`
set MAC28=`echo $KC | grep 'xdaap'`
set MAC29=`echo $KC | grep 'spiro'`
set MAC30=`echo $KC | grep 'eos'`

# pour forcer la compilation avec pgi sur visio
#set MAC14="pgi"
 
unset KC

# ----------------------------- Common ----------------------------------------
#setenv ELSADIST $CASSIOPEE  # production (cfg)
#setenv ELSAPATH $CASSIOPEE  # production (cfg)
#setenv ELSAWKSP $CASSIOPEE  # production (cfg)

# Si la variable ELSA est dans l'environnement, on cree des chemins compatibles
# avec la version public : par ex: ELSA=/home/elsa/Public/v3.6.02 [eos only]

if ($%MAC0 != 0) then
#----------------------------- ld centos 7 -------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD x86_mpi_dbg_r8
                else
                        setenv ELSAPROD x86_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD x86_dbg_r8
                else
                        setenv ELSAPROD x86_r8
                endif
        endif
        # Modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load python/2.7.8
        module load intel/17.0.4
        module unload impi/17
        module load hdf5/1.8.8
        # Number of threads
        set ncpu=`cat /proc/cpuinfo |grep processor |cut -f2 -d: |tail -1`
        @ ncpu++
        setenv OMP_NUM_THREADS $ncpu
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7],explicit"
        # chemin de mpirun (forced)
        set path=(/usr/lib64/openmpi/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        if ($?ELSA == 0) then # Cassiopee Kernel
            # Chemin de elsA.x
            set path=($CASSIOPEE/Dist/bin/$ELSAPROD $path)
            setenv LD_LIBRARY_PATHL /usr/lib64:/home/benoit/lib:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8/lib:/usr/lib64/openmpi/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8:$CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages
        else # elsA public
            set path=($ELSA/Dist/bin/eos-intel $path)
            setenv LD_LIBRARY_PATHL /usr/lib64:/home/benoit/lib:$ELSA/Dist/bin/eos-intel:$ELSA/Dist/bin/eos-intel/lib:/usr/local/python/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages:$ELSA/Dist/lib/py:$ELSA/Dist/bin/eos-intel
        endif
        # Pour utilisation MKL+numpy
        setenv LD_PRELOAD /opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_avx2.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_def.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_core.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_intel_lp64.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_intel_thread.so:/opt/tools/intel/studio/2017/lib/intel64/libiomp5.so

else if ($%MAC30 != 0) then
#----------------------------- eos -------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD x86_mpi_dbg_r8
                else
                        setenv ELSAPROD x86_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD x86_dbg_r8
                else
                        setenv ELSAPROD x86_r8
                endif
        endif
        # Modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load python/2.7.8
        module load intel/17.0.4
        module unload impi/17
        module load hdf5/1.8.8
        # Number of threads
        set ncpu=`cat /proc/cpuinfo |grep processor |cut -f2 -d: |tail -1`
        @ ncpu++
        setenv OMP_NUM_THREADS $ncpu
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7],explicit"
        # chemin de mpirun (forced)
        set path=(/usr/lib64/openmpi/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        if ($?ELSA == 0) then # Cassiopee Kernel
            # Chemin de elsA.x
            set path=($CASSIOPEE/Dist/bin/$ELSAPROD $path)
            setenv LD_LIBRARY_PATHL /usr/lib64:/stck/benoit/lib:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8/lib:/usr/lib64/openmpi/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8:$CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages
        else # elsA public
            set path=($ELSA/Dist/bin/eos-intel $path)
            setenv LD_LIBRARY_PATHL /usr/lib64:/stck/benoit/lib:$ELSA/Dist/bin/eos-intel:$ELSA/Dist/bin/eos-intel/lib:/usr/local/python/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages:$ELSA/Dist/lib/py:$ELSA/Dist/bin/eos-intel
        endif
        # Pour utilisation MKL+numpy
        setenv LD_PRELOAD /opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_avx2.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_def.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_core.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_intel_lp64.so:/opt/tools/intel/studio/2017/mkl/lib/intel64/libmkl_intel_thread.so:/opt/tools/intel/studio/2017/lib/intel64/libiomp5.so

else if ($%MAC3 != 0) then
#----------------------------- Mac OSX-----------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD macosx_mpi_dbg_r8
                else
                        setenv ELSAPROD macosx_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD macosx_dbg_r8
                else
                        setenv ELSAPROD macosx_r8
                endif
        endif
	setenv OMP_NUM_THREADS 2
	set path=($path $CASSIOPEE/Dist/bin/macosx_r8)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD"/lib:/opt/intel/composer_xe_2015/lib
        unsetenv BUNDLE
        setenv MACOSX_DEPLOYMENT_TARGET 10.10
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD"/lib/python2.7/site-packages
	setenv DYLD_LIBRARY_PATH $LD_LIBRARY_PATHL

else if ($%MAC4 != 0) then
#-------------------------------- SGI -----------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD sgi_mpi_dbg_r8
                else
                        setenv ELSAPROD sgi_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD sgi_dbg_r8
                else
                        setenv ELSAPROD sgi_r8
                endif
        endif
        setenv LD_LIBRARY_PATHL /tools/py/tmp/local/lib/:$CASSIOPEE/Kernel/lib/$ELSAPROD

else if ($%MAC5 != 0) then
#------------------------------- mangrove --------------------------------------
        if ($MPI == true) then
                setenv MPI_BUFFER_MAX
                if ($DBG == true) then
                        setenv decfort_dump_flag true
                        setenv ELSAPROD man_mpi_dbg_r8
                else
                        setenv ELSAPROD man_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv decfort_dump_flag true
                        setenv ELSAPROD man_dbg_r8
                else
                        setenv ELSAPROD man_r8
                endif
        endif
        setenv OMP_NUM_THREADS 4
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /opt/intel/Compiler/11.0/083/lib:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/man_r8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/man_r8:$CASSIOPEE/Dist/bin/man_r8/lib/python2.6/site-packages

else if ($%MAC6 != 0) then
#-------------------------------- ubuntu ------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD ub_mpi_dbg_r8
                else
                        setenv ELSAPROD ub_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD ub_dbg_r8
                else
                        setenv ELSAPROD ub_r8
                endif
        endif
        setenv OMP_NUM_THREADS 2
        # chemin de l'executable python
        set path=(/benoit/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/ub_r8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/ub_r8:$CASSIOPEE/Dist/bin/ub_r8/lib/python2.5/site-packages

else if ($%MAC7 != 0) then
#-------------------------------- cc-wdsna ------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD rhpo_mpi_dbg_r8
                else
                        setenv ELSAPROD rhpo_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD rhpo_dbg_r8
                else
                        setenv ELSAPROD rhpo_r8
                endif
        endif
        # Nombre de threads
        setenv OMP_NUM_THREADS 2
        # chemin de l'executable python
        set path=(/benoit/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /home/benoit/lib:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/rhpo_r8/lib
        setenv PYTHONPATHL /home/benoit/lib/python2.6/site-packages:$CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/rhpo_r8:$CASSIOPEE/Dist/bin/rhpo_r8/lib/python2.6/site-packages
	setenv CGNSPATH /home/benoit

else if ($%MAC11 != 0) then
#------------------------------- fulvio ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD flv_mpi_dbg_r8
                else
                        setenv ELSAPROD flv_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD flv_dbg_r8
                else
                        setenv ELSAPROD flv_r8
                endif
        endif
	foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load   intel/15.0.6
	#module load   impi/15
        # Nombre de threads
        setenv OMP_NUM_THREADS 8
        # Chemin de python
        set path=(/usr/local/python/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/flv_r8/lib:/usr/local/lib64:/usr/local/hdf5-intel-1.8.8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/flv_r8:$CASSIOPEE/Dist/bin/flv_r8/lib/python2.7/site-packages

else if ($%MAC12 != 0) then
#-------------------------------- fujin ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD fuj_mpi_dbg_r8
                else
                        setenv ELSAPROD fuj_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD fuj_dbg_r8
                else
                        setenv ELSAPROD fuj_r8
                endif
        endif
        setenv OMP_NUM_THREADS 8
        # Chemin de python
        set path=(/home/benoit/x86_64f/bin $path) 
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /home/benoit/x86_64f/lib:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/fuj_r8/lib
        setenv PYTHONPATHL /home/benoit/lib/python2.7/site-packages:$CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/fuj_r8/lib:$CASSIOPEE/Dist/bin/fuj_r8/lib/python2.7/site-packages

else if ($%MAC13 != 0) then
#------------------------------- daapuv --------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD uv_mpi_dbg_r8
                else
                        setenv ELSAPROD uv_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD uv_dbg_r8
                else
                        setenv ELSAPROD uv_r8
                endif
        endif
        setenv OMP_NUM_THREADS 4
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/uv_r8/lib:/usr/local/hdf5-1.8.7/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/uv_r8:$CASSIOPEE/Dist/bin/uv_r8/lib/python2.6/site-packages

else if ($MAC14 == "pgi") then
#------------------------------- visio+PGI ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD pgi_mpi_dbg_r8
                else
                        setenv ELSAPROD pgi_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD pgi_dbg_r8
                else
                        setenv ELSAPROD pgi_r8
                endif
        endif
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load pgi/14.4
        # Nombre de threads
        setenv OMP_NUM_THREADS 16
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],explicit"
        # Chemin de python
        set path=(/usr/local/python/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/vis_r8/lib:/usr/local/hdf5-intel-1.8.8/lib:/usr/local/lib64:/usr/lib64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/pgi_r8:$CASSIOPEE/Dist/bin/vis_r8/lib/python2.7/site-packages

else if ($%MAC14 != 0 || $%MAC18 != 0 || $%MAC19 != 0 || $%MAC20 != 0 || $%MAC21 != 0) then
#------------------------------- visio ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD vis_mpi_dbg_r8
                else
                        setenv ELSAPROD vis_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD vis_dbg_r8
                else
                        setenv ELSAPROD vis_r8
                endif
        endif
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load intel/15.0.6
        #module load impi/15
        # Nombre de threads
        setenv OMP_NUM_THREADS 16
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],explicit"
        # Chemin de python
        set path=(/usr/local/python/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/vis_r8/lib:/usr/local/hdf5-intel-1.8.8/lib:/usr/local/lib64:/usr/lib64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/vis_r8:$CASSIOPEE/Dist/bin/vis_r8/lib/python2.7/site-packages

else if ($%MAC15 != 0) then
#------------------------------- tiamat ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD tia_mpi_dbg_r8
                else
                        setenv ELSAPROD tia_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD tia_dbg_r8
                else
                        setenv ELSAPROD tia_r8
                endif
        endif
        # Nombre de threads
        setenv OMP_NUM_THREADS 12
        #setenv OMP_STACKSIZE "8M"
        setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7,8,9,10,11],explicit"
        # modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load intel/16.0.4
        # Chemin de go
        set path=(/home/tools/local/tiamat/bin $path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /home/tools/local/tiamat/lib:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/tia_r8/lib64:/home/benoit/x86_64t/lib
        setenv PYTHONPATHL /home/tools/local/tiamat/lib/python2.7:$CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/tia_r8:$CASSIOPEE/Dist/bin/tia_r8/lib64/python2.7/site-packages

else if ($%MAC16 != 0) then
#------------------------------- austri ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD aus_mpi_dbg_r8
                else
                        setenv ELSAPROD aus_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD aus_dbg_r8
                else
                        setenv ELSAPROD aus_r8
                endif
        endif
        # Nombre de threads
        setenv OMP_NUM_THREADS 24
        setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,2,4,6,8,10,12,14,16,18,20,22,1,3,5,7,9,11,13,15,17,19,21,23],explicit"
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,2,4,6,8,10,12,14,16,18,20,22,1,3,5,7,9,11,13,15,17,19,21,23,24,26,28,30,32,34,36,38,40,42,44,46,25,27,29,31,33,35,37,39,41,43,45,47],explicit"
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[1,3,5,7,9,11,13,15,17,19,21,23,0,2,4,6,8,10,12,14,16,18,20,22,25,27,29,31,33,35,37,39,41,43,45,47,24,26,28,30,32,34,36,38,40,42,44,46],explicit"
        setenv PROC_NAME "HASWELL"
        # modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load intel/17.0.4
        module load impi/17 # very bad install
        module unload impi/17
        #module load gcc/5.2
        module load hdf5/1.8.8-intel-11
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /home/benoit/aus/lib:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/aus_r8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/aus_r8:$CASSIOPEE/Dist/bin/aus_r8/lib/python2.7/site-packages

else if ($%MAC17 != 0) then
#------------------------------- laura ----------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD laura_mpi_dbg_r8
                else
                        setenv ELSAPROD laura_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD laura_dbg_r8
                else
                        setenv ELSAPROD laura_r8
                endif
        endif
        # chargement des modules
        #source /usr/share/modules/init/csh
        module load python/2.7.3.icc-mpt
        module load hdf5/1.8.7
        module load intel-mkl-10/10.3.1
        module load intel-cce-12/12.0.1.107
        module load intel-fce-12/12.0.1.107
        module load mpt/2.02
        setenv OMP_NUM_THREADS 12
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/laura_r8/lib:/home/benoit/laura/lib:/usr/local/lib64:/opt/intel/composerxe-2011.1.107/compiler/lib/intel64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/laura_r8:$CASSIOPEE/Dist/bin/laura_r8/lib/python2.7/site-packages

else if ($%MAC22 != 0) then
#------------------------------- linux64 ---------------------------------------
        setenv ELSAPROD linux64
        # Number of threads
        setenv OMP_NUM_THREADS 4
        # chemin de python
        set path=(/usr/local/python/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($CASSIOPEE/Dist/bin/$ELSAPROD $path)
        setenv LD_LIBRARY_PATHL /home/benoit/lib:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/linux64/lib:/usr/local/python/lib:/usr/lib64/openmpi/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/linux64:$CASSIOPEE/Dist/bin/linux64/lib/python2.7/site-packages

else if ($%MAC23 != 0) then
#------------------------------- moloch ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD mol_mpi_dbg_r8
                else
                        setenv ELSAPROD mol_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD mol_dbg_r8
                else
                        setenv ELSAPROD mol_r8
                endif
        endif
        # modules
        module load python/2.6.4/11.mpt
        module load hdf5/1.8.8-intel-11
        # Nombre de threads
        setenv OMP_NUM_THREADS 12
        # Chemin de go
        set path=(/usr/bin $path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/mol_r8/lib64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/mol_r8:$CASSIOPEE/Dist/bin/mol_r8/lib64/python2.6/site-packages

else if ($%MAC24 != 0) then
#------------------------------- giulia ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD giu_mpi_dbg_r8
                else
                        setenv ELSAPROD giu_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD giu_dbg_r8
                else
                        setenv ELSAPROD giu_r8
                endif
        endif
        # Nombre de threads
        set ncpu=`cat /proc/cpuinfo |grep processor |cut -f2 -d: |tail -1`
        @ ncpu++
        setenv OMP_NUM_THREADS $ncpu
        # modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        #module load gcc/5.2
        module load intel/17.0.4
        module load python/2.7.8
        module unload hdf5/1.8.8
        module load hdf5/1.8.8-intel-16.impi
        module load impi/16
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/giu_r8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/giu_r8:$CASSIOPEE/Dist/bin/giu_r8/lib/python2.7/site-packages

else if ($%MAC25 != 0) then
#------------------------------- westri (KNL) ---------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD wes_mpi_dbg_r8
                else
                        setenv ELSAPROD wes_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD wes_dbg_r8
                else
                        setenv ELSAPROD wes_r8
                endif
        endif
        # Nombre de threads
        setenv OMP_NUM_THREADS 64
        setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],explicit"
        # modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load intel/17.0.4
        module load python/2.7.8
        module load hdf5/1.8.8-intel-16
        #module load hdf5/1.8.8-intel-16.impi

        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/wes_r8/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/giu_r8:$CASSIOPEE/Dist/bin/wes_r8/lib/python2.7/site-packages

else if ($%MAC1 != 0) then
#-------------------------------- ld (centos6) -----------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv decfort_dump_flag true
                        setenv ELSAPROD x86_mpi_dbg_r8
                else
                        setenv ELSAPROD x86_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD x86_dbg_r8
                else
                        setenv ELSAPROD x86_r8
                endif
        endif
        # Modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        module load intel/13.1.3
        module load impi/13
        module load hdf5/1.8.8
        # Number of threads
        set ncpu=`cat /proc/cpuinfo |grep processor |cut -f2 -d: |tail -1`
        @ ncpu++
        setenv OMP_NUM_THREADS $ncpu
        #setenv KMP_AFFINITY "verbose,granularity=fine,proclist=[0,1,2,3,4,5,6,7],explicit"
        # chemin de python
        set path=(/usr/local/python/bin $path)
        # chemin de mpirun (forced)
        set path=(/usr/lib64/openmpi/bin $path)
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        if ($?ELSA == 0) then # Cassiopee Kernel
            # Chemin de elsA.x
            set path=($CASSIOPEE/Dist/bin/$ELSAPROD $path)
            setenv LD_LIBRARY_PATHL /home/benoit/lib:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8/lib:/usr/local/python/lib:/usr/lib64/openmpi/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/x86_r8:$CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages
        else # elsA public
            set path=($ELSA/Dist/bin/eos-intel $path)
            setenv LD_LIBRARY_PATHL /home/benoit/lib:$ELSA/Dist/bin/eos-intel:$ELSA/Dist/bin/eos-intel/lib:/usr/local/python/lib
            setenv PYTHONPATHL $CASSIOPEE/Dist/bin/x86_r8/lib/python2.7/site-packages:$ELSA/Dist/lib/py:$ELSA/Dist/bin/eos-intel
        endif

else if ($%MAC28 != 0) then
#------------------------------- xdaap --------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD xdaap_mpi_dbg_r8
                else
                        setenv ELSAPROD xdaap_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD xdaap_dbg_r8
                else
                        setenv ELSAPROD xdaap_r8
                endif
        endif
        # Modules
        foreach x (`(echo "" ; module -t list) | & grep intel`)
            module unload $x
        end
        #module load gcc/4.8.1
        module load intel/15.0.6
        # Number of threads
        setenv OMP_NUM_THREADS 16
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /usr/lib64/:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/xdaap_r8/lib:/usr/local/hdf5-intel-1.8.8/lib:/usr/local/lib64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/xdaap_r8:$CASSIOPEE/Dist/bin/xdaap_r8/lib/python2.7/site-packages

else if ($%MAC29 != 0) then
#------------------------------- spiro --------------------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD spiro_mpi_dbg_r8
                else
                        setenv ELSAPROD spiro_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD spiro_dbg_r8
                else
                        setenv ELSAPROD spiro_r8
                endif
        endif
        module load CFD/4.0-intel-17.impi
        
        # Number of threads
        setenv OMP_NUM_THREADS 24
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL /usr/lib64/:$CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/spiro_r8/lib:/usr/local/hdf5-intel-1.8.8/lib:/usr/local/lib64
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/spiro_r8:$CASSIOPEE/Dist/bin/spiro_r8/lib/python2.7/site-packages

else if ($%MAC26 != 0 || $%MAC27 != 0) then
#------------------------------- sator --------------------------------------
# En dernier a cause de 'n'
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD sat_mpi_dbg_r8
                else
                        setenv ELSAPROD sat_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD sat_dbg_r8
                else
                        setenv ELSAPROD sat_r8
                endif
        endif
        module unload intel/11.1.073
        module load CFD/4.0-intel-17.impi
        #module load intel/17.0.4 impi/17 python/2.7.8-intel-17.impi

        # HDF para (deja dans le socle)
        # module load hdf5/1.8.17-intel-17.impi
        
        # Number of threads
        setenv OMP_NUM_THREADS 28
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/stv_r8/lib:/tmp_user/stelvio/benoit/sator/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/sat_r8:$CASSIOPEE/Dist/bin/sat_r8/lib/python2.7/site-packages

else if ($%MAC9 != 0 || $%MAC10 != 0) then
#------------------------------- stelvio --------------------------------------
#------------------------ en dernier a cause de 'r' ---------------------------
        if ($MPI == true) then
                if ($DBG == true) then
                        setenv ELSAPROD stv_mpi_dbg_r8
                else
                        setenv ELSAPROD stv_mpi_r8
                endif
        else
                if ($DBG == true) then
                        setenv ELSAPROD stv_dbg_r8
                else
                        setenv ELSAPROD stv_r8
                endif
        endif
        module unload intel/11.1.073
        module load CFD/2.0/15.mpt
        # HDF para
        module load hdf5/1.8.8-intel-15.mpt
        
        # Number of threads
        setenv OMP_NUM_THREADS 4
        # Chemin de go
        set path=($path $CASSIOPEE/Dist/bin)
        # Chemin de elsA.x
        set path=($path $CASSIOPEE/Dist/bin/$ELSAPROD)
        setenv LD_LIBRARY_PATHL $CASSIOPEE/Kernel/lib/"$ELSAPROD":$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/stv_r8/lib:/tmp_user/stelvio/benoit/stelvio/lib
        setenv PYTHONPATHL $CASSIOPEE/Dist/lib/py:$CASSIOPEE/Dist/bin/"$ELSAPROD":$CASSIOPEE/Dist/bin/stv_r8:$CASSIOPEE/Dist/bin/stv_r8/lib/python2.7/site-packages
endif
#---------------------------Common---------------------------------------------
alias emake "make -f Makefile.$ELSAPROD"

set STE=$LD_LIBRARY_PATHL
set STES='*'$STE'*'
if ($?LD_LIBRARY_PATH == 0) then
    setenv LD_LIBRARY_PATH $STE
else
    switch ($LD_LIBRARY_PATH)
    case $STES:
#        echo '->var detected; not added'
        breaksw
    default:
#        echo $LD_LIBRARY_PATH, $STE 
        setenv LD_LIBRARY_PATH "$STE":"$LD_LIBRARY_PATH"
        breaksw
    endsw
endif
#echo $LD_LIBRARY_PATH

set STE=$PYTHONPATHL
set STES='*'$STE'*'
if ($?PYTHONPATH == 0) then
    setenv PYTHONPATH $STE
else
    switch ($PYTHONPATH)
    case $STES:
#        echo '->var detected; not added'
        breaksw
    default:
#        echo $PYTHONPATH, $STE 
        setenv PYTHONPATH "$STE":"$PYTHONPATH"
        breaksw
    endsw
endif
#echo $PYTHONPATH

#echo $ELSAPROD' environment set.'
